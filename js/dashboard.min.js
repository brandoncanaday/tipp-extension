!function(){function e(){n("","green"),setTimeout(()=>{l("tipp_account",{}),window.location.replace(chrome.runtime.getURL("splash.html"))},700)}function t(){a("tipp_account").stripe?(document.querySelector("#stripe-dashboard-btn a").style.display="block",document.querySelector("#stripe-connect-btn a").style.display="none"):(document.querySelector("#stripe-dashboard-btn a").style.display="none",document.querySelector("#stripe-connect-btn a").style.display="block")}function n(e,t){let n=document.querySelector(".tipp-preloader-modal"),c=n.querySelector(".spinner-layer");switch(document.querySelector(".tipp-preloader-modal .msg").textContent=e,c.classList.remove("spinner-blue-only"),c.classList.remove("spinner-red-only"),c.classList.remove("spinner-green-only"),t){case"blue":c.classList.add("spinner-blue-only");break;case"red":c.classList.add("spinner-red-only");break;case"green":default:c.classList.add("spinner-green-only")}n.style.display="block"}function c(){document.querySelector(".tipp-preloader-modal").style.display="none"}function r(e,t){document.querySelector(t).src=e}function o(e,t){let n=document.createElement("li");n.id+="channel-collection-item";let c=function(e){let t=document.createElement("ul");return t.className+="collection yt-channels ",e.forEach(e=>{let n=function(e,t,n,c){let r=document.createElement("div"),o=document.createElement("img"),l=document.createTextNode(n),a=c?function(e){let t=document.createElement("i"),n=document.createTextNode(e);return t.className+="material-icons ",t.appendChild(n),t}(c):null;return r.className+="chip ",r.className+=e+" ",o.src=t,r.appendChild(o),r.appendChild(l),a&&r.appendChild(a),r}("yt-channel",e.channelIcon,e.channelName,"check");t.appendChild(n)}),t}(e);n.appendChild(c);const r=document.querySelector("#channel-collection-item");r&&r.remove(),$(t).after(n)}function l(e,t){localStorage.setItem(e,JSON.stringify(t))}function a(e){return JSON.parse(localStorage.getItem(e))}$(".hamburger").sideNav(),$(".modal").modal(),function(){n("","green");const e=a("tipp_account");$(".user-view .name").text(`${e.fname} ${e.lname}`),$(".user-view .username").text(`@${e.displayname}`),t(),e.channels.length&&(r(e.channels[0].channelIcon,".user-view .profile-pic"),o(e.channels,"#yt-account"));setTimeout(()=>c(),700)}(),document.querySelector("#stripe-connect-btn a").addEventListener("click",function(){n("","blue"),setTimeout(()=>{chrome.runtime.sendMessage({message:"start_stripe_oauth"},n=>{n.error?"forbidden"==n.error.type?e():c():(t(),c())})},700)}),document.querySelector("#stripe-dashboard-btn a").addEventListener("click",function(){a("tipp_account").stripe&&(n("","blue"),setTimeout(()=>{chrome.runtime.sendMessage({message:"open_stripe_dashboard"},t=>{t.error&&"forbidden"==t.error.type?e():c()})},700))}),document.querySelector("#logout-btn a").addEventListener("click",e),document.querySelector("#yt-connect-btn a").addEventListener("click",function(){n("","red"),setTimeout(()=>{chrome.runtime.sendMessage({message:"start_youtube_connect_flow"},t=>{if(t.error)"forbidden"==t.error.type?e():c();else{const e=a("tipp_account");e.channels.length&&(r(e.channels[0].channelIcon,".user-view .profile-pic"),o(e.channels,"#yt-account")),c()}})},700)}),document.querySelector("#delete-account-btn").addEventListener("click",function(){n("","green"),setTimeout(()=>{chrome.runtime.sendMessage({message:"delete_user"},t=>{t.error?"forbidden"==t.error.type?e():c():(l("tipp_account",{}),window.location.replace(chrome.runtime.getURL("splash.html")))})},700)})}();
